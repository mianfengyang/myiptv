import time
import concurrent.futures
from selenium import webdriver
from selenium.webdriver.chrome.options import Options
from selenium.webdriver.chrome.service import Service
import requests
import re
import os
import wget
import subprocess
import threading
from queue import Queue

from censys.search import CensysHosts

os.environ['no_proxy'] = '*'

# h = CensysHosts()
# query = h.search("services.http.response.body: ZHGXTV", per_page=10)
query = [{'services': [{'service_name': 'FTP', 'extended_service_name': 'FTP', 'port': 21, 'transport_protocol': 'TCP'}, {'transport_protocol': 'TCP', 'service_name': 'SSH', 'extended_service_name': 'SSH', 'port': 22}, {'service_name': 'HTTP', 'extended_service_name': 'HTTP', 'port': 80, 'transport_protocol': 'TCP'}, {'service_name': 'NTP', 'port': 123, 'extended_service_name': 'NTP', 'transport_protocol': 'UDP'}, {'certificate': '0d6dcdd2fd76bc27568bbe1c8034b84a37954e8d65d8d1e974cb9ac61cc1abbe', 'service_name': 'HTTP', 'extended_service_name': 'HTTPS', 'port': 443, 'transport_protocol': 'TCP'}, {'transport_protocol': 'TCP', 'port': 5286, 'extended_service_name': 'SSH', 'service_name': 'SSH'}, {'port': 8080, 'service_name': 'HTTP', 'extended_service_name': 'HTTP', 'transport_protocol': 'TCP'}, {'transport_protocol': 'TCP', 'port': 19905, 'service_name': 'SSH', 'extended_service_name': 'SSH'}, {'port': 20009, 'service_name': 'SSH', 'extended_service_name': 'SSH', 'transport_protocol': 'TCP'}, {'transport_protocol': 'TCP', 'port': 20014, 'service_name': 'SSH', 'extended_service_name': 'SSH'}, {'port': 20019, 'service_name': 'SSH', 'extended_service_name': 'SSH', 'transport_protocol': 'TCP'}, {'port': 20023, 'service_name': 'SSH', 'transport_protocol': 'TCP', 'extended_service_name': 'SSH'}, {'extended_service_name': 'SSH', 'transport_protocol': 'TCP', 'port': 20024, 'service_name': 'SSH'}, {'extended_service_name': 'SSH', 'service_name': 'SSH', 'transport_protocol': 'TCP', 'port': 20025}, {'service_name': 'SSH', 'port': 20031, 'extended_service_name': 'SSH', 'transport_protocol': 'TCP'}, {'extended_service_name': 'SSH', 'transport_protocol': 'TCP', 'port': 20032, 'service_name': 'SSH'}, {'service_name': 'SSH', 'transport_protocol': 'TCP', 'extended_service_name': 'SSH', 'port': 20033}, {'extended_service_name': 'SSH', 'transport_protocol': 'TCP', 'port': 20034, 'service_name': 'SSH'}, {'port': 20035, 'transport_protocol': 'TCP', 'extended_service_name': 'SSH', 'service_name': 'SSH'}, {'transport_protocol': 'TCP', 'port': 20036, 'service_name': 'SSH', 'extended_service_name': 'SSH'}, {'service_name': 'SSH', 'extended_service_name': 'SSH', 'port': 20037, 'transport_protocol': 'TCP'}, {'transport_protocol': 'TCP', 'extended_service_name': 'SSH', 'service_name': 'SSH', 'port': 20038}, {'transport_protocol': 'TCP', 'port': 20040, 'extended_service_name': 'SSH', 'service_name': 'SSH'}, {'service_name': 'SSH', 'transport_protocol': 'TCP', 'extended_service_name': 'SSH', 'port': 20041}, {'transport_protocol': 'TCP', 'port': 20042, 'extended_service_name': 'SSH', 'service_name': 'SSH'}, {'port': 20045, 'extended_service_name': 'SSH', 'transport_protocol': 'TCP', 'service_name': 'SSH'}, {'port': 20046, 'transport_protocol': 'TCP', 'service_name': 'SSH', 'extended_service_name': 'SSH'}, {'service_name': 'SSH', 'extended_service_name': 'SSH', 'port': 20048, 'transport_protocol': 'TCP'}, {'service_name': 'SSH', 'transport_protocol': 'TCP', 'port': 20056, 'extended_service_name': 'SSH'}, {'service_name': 'SSH', 'port': 20103, 'transport_protocol': 'TCP', 'extended_service_name': 'SSH'}, {'service_name': 'SSH', 'transport_protocol': 'TCP', 'extended_service_name': 'SSH', 'port': 20923}, {'transport_protocol': 'TCP', 'service_name': 'SSH', 'extended_service_name': 'SSH', 'port': 21022}, {'service_name': 'SSH', 'extended_service_name': 'SSH', 'transport_protocol': 'TCP', 'port': 21031}, {'service_name': 'SSH', 'extended_service_name': 'SSH', 'transport_protocol': 'TCP', 'port': 21065}, {'port': 21107, 'transport_protocol': 'TCP', 'extended_service_name': 'SSH', 'service_name': 'SSH'}, {'transport_protocol': 'TCP', 'port': 21122, 'extended_service_name': 'SSH', 'service_name': 'SSH'}, {'port': 21205, 'service_name': 'SSH', 'extended_service_name': 'SSH', 'transport_protocol': 'TCP'}, {'service_name': 'SSH', 'port': 21605, 'extended_service_name': 'SSH', 'transport_protocol': 'TCP'}, {'service_name': 'SSH', 'port': 21901, 'extended_service_name': 'SSH', 'transport_protocol': 'TCP'}, {'service_name': 'SSH', 'port': 22624, 'extended_service_name': 'SSH', 'transport_protocol': 'TCP'}, {'service_name': 'SSH', 'extended_service_name': 'SSH', 'port': 25272, 'transport_protocol': 'TCP'}, {'extended_service_name': 'SSH', 'transport_protocol': 'TCP', 'service_name': 'SSH', 'port': 26101}, {'transport_protocol': 'TCP', 'extended_service_name': 'SSH', 'port': 26102, 'service_name': 'SSH'}, {'extended_service_name': 'SSH', 'transport_protocol': 'TCP', 'port': 27402, 'service_name': 'SSH'}, {'port': 28062, 'service_name': 'SSH', 'transport_protocol': 'TCP', 'extended_service_name': 'SSH'}], 'autonomous_system': {'country_code': 'CN', 'asn': 37963, 'name': 'ALIBABA-CN-NET Hangzhou Alibaba Advertising Co.,Ltd.', 'description': 'ALIBABA-CN-NET Hangzhou Alibaba Advertising Co.,Ltd.', 'bgp_prefix': '114.55.128.0/17'}, 'last_updated_at': '2024-03-27T20:52:34.863Z', 'location': {'timezone': 'Asia/Shanghai', 'city': 'Hangzhou', 'continent': 'Asia', 'country': 'China', 'country_code': 'CN', 'province': 'Zhejiang', 'coordinates': {'longitude': 120.16142, 'latitude': 30.29365}}, 'ip': '114.55.143.231'}, {'operating_system': {'cpe': 'cpe:2.3:o:*:linux:*:*:*:*:*:*:*:*', 'component_uniform_resource_identifiers': [], 'other': [], 'product': 'linux', 'source': 'OSI_TRANSPORT_LAYER', 'part': 'o'}, 'ip': '47.107.104.87', 'last_updated_at': '2024-03-27T23:43:09.709Z', 'services': [{'transport_protocol': 'TCP', 'service_name': 'FTP', 'extended_service_name': 'FTPes', 'certificate': 'cf792942e4f830d2195b26e1ee977c7bf25dfaa5b3148ea9682517f17542b2ae', 'port': 21}, {'service_name': 'SSH', 'transport_protocol': 'TCP', 'port': 22, 'extended_service_name': 'SSH'}, {'port': 80, 'service_name': 'HTTP', 'extended_service_name': 'HTTP', 'transport_protocol': 'TCP'}, {'service_name': 'HTTP', 'extended_service_name': 'HTTPS', 'transport_protocol': 'TCP', 'certificate': '5672010384261f8490b0b360018275e59ed896ac69f41d035d41edaab5c09efa', 'port': 443}, {'port': 888, 'service_name': 'HTTP', 'extended_service_name': 'HTTP', 'transport_protocol': 'TCP'}, {'service_name': 'HTTP', 'port': 6557, 'transport_protocol': 'TCP', 'extended_service_name': 'HTTP'}], 'autonomous_system': {'bgp_prefix': '47.107.0.0/16', 'name': 'ALIBABA-CN-NET Hangzhou Alibaba Advertising Co.,Ltd.', 'country_code': 'CN', 'description': 'ALIBABA-CN-NET Hangzhou Alibaba Advertising Co.,Ltd.', 'asn': 37963}, 'location': {'country': 'China', 'continent': 'Asia', 'postal_code': '518000', 'country_code': 'CN', 'timezone': 'Asia/Shanghai', 'city': 'Shenzhen', 'coordinates': {'latitude': 22.54554, 'longitude': 114.0683}, 'province': 'Guangdong'}}, {'autonomous_system': {'country_code': 'CN', 'asn': 37963, 'bgp_prefix': '39.106.0.0/15', 'description': 'ALIBABA-CN-NET Hangzhou Alibaba Advertising Co.,Ltd.', 'name': 'ALIBABA-CN-NET Hangzhou Alibaba Advertising Co.,Ltd.'}, 'location': {'country': 'China', 'coordinates': {'latitude': 39.9075, 'longitude': 116.39723}, 'city': 'Beijing', 'country_code': 'CN', 'timezone': 'Asia/Shanghai', 'continent': 'Asia', 'province': 'Beijing'}, 'operating_system': {'vendor': 'Microsoft', 'cpe': '', 'part': 'o', 'component_uniform_resource_identifiers': [], 'other': [{'value': 'Windows', 'key': 'family'}], 'source': 'OSI_APPLICATION_LAYER'}, 'services': [{'transport_protocol': 'TCP', 'service_name': 'HTTP', 'extended_service_name': 'HTTP', 'port': 80}], 'ip': '39.107.240.215', 'last_updated_at': '2024-03-18T00:43:38.160Z'}, {'autonomous_system': {'country_code': 'SG', 'asn': 63949, 'name': 'AKAMAI-LINODE-AP Akamai Connected Cloud', 'description': 'AKAMAI-LINODE-AP Akamai Connected Cloud', 'bgp_prefix': '162.216.16.0/22'}, 'last_updated_at': '2024-03-27T21:26:53.526Z', 'operating_system': {'product': 'linux', 'source': 'OSI_TRANSPORT_LAYER', 'other': [], 'component_uniform_resource_identifiers': [], 'cpe': 'cpe:2.3:o:*:linux:*:*:*:*:*:*:*:*', 'part': 'o'}, 'ip': '162.216.19.160', 'location': {'country': 'United States', 'country_code': 'US', 'city': 'Morris Plains', 'postal_code': '07927', 'province': 'New Jersey', 'timezone': 'America/New_York', 'coordinates': {'latitude': 40.8223, 'longitude': -74.4569}, 'continent': 'North America'}, 'services': [{'service_name': 'FTP', 'transport_protocol': 'TCP', 'extended_service_name': 'FTPes', 'port': 21, 'certificate': '11e03e1b34845756129721b46ae88e2bbc6363eaa5b005965c6f672e5796757c'}, {'extended_service_name': 'SSH', 'service_name': 'SSH', 'port': 22, 'transport_protocol': 'TCP'}, {'transport_protocol': 'TCP', 'port': 25, 'service_name': 'SMTP', 'certificate': 'adda25d07ba1c982f4ce61812c663cbb042e1e595639f92e775e1daa2fe68567', 'extended_service_name': 'SMTP-STARTTLS'}, {'service_name': 'DNS', 'transport_protocol': 'UDP', 'extended_service_name': 'DNS', 'port': 53}, {'service_name': 'HTTP', 'port': 80, 'transport_protocol': 'TCP', 'extended_service_name': 'HTTP'}, {'service_name': 'POP3', 'extended_service_name': 'POP3', 'transport_protocol': 'TCP', 'port': 110}, {'port': 143, 'service_name': 'IMAP', 'extended_service_name': 'IMAP', 'transport_protocol': 'TCP'}, {'service_name': 'HTTP', 'port': 443, 'extended_service_name': 'HTTPS', 'certificate': '49bc7dc0b02260139f52cd28a92046bc9d914d1f19c87588184bd923cdc54fe6', 'transport_protocol': 'TCP'}, {'port': 465, 'transport_protocol': 'TCP', 'service_name': 'SMTP', 'extended_service_name': 'SMTPS', 'certificate': 'adda25d07ba1c982f4ce61812c663cbb042e1e595639f92e775e1daa2fe68567'}, {'transport_protocol': 'TCP', 'service_name': 'SMTP', 'extended_service_name': 'SMTP-STARTTLS', 'port': 587, 'certificate': 'adda25d07ba1c982f4ce61812c663cbb042e1e595639f92e775e1daa2fe68567'}, {'extended_service_name': 'RSYNC', 'service_name': 'RSYNC', 'port': 873, 'transport_protocol': 'TCP'}, {'service_name': 'SSH', 'port': 2222, 'transport_protocol': 'TCP', 'extended_service_name': 'SSH'}, {'certificate': '537ee3a02a805a4a6b917dc8ced4beeea90dc15889031bcabc833e8fa323eda3', 'service_name': 'MYSQL', 'transport_protocol': 'TCP', 'extended_service_name': 'MYSQL', 'port': 3306}, {'port': 10000, 'extended_service_name': 'HTTPS', 'service_name': 'HTTP', 'certificate': '832af22fd0fea63c3070e889af584e5e34b0fce1e5e319d935c83e24d86cbe2e', 'transport_protocol': 'TCP'}, {'certificate': '7f43a02396a92da18903964e9547e574145de43a979471eea6dc89d695504d36', 'transport_protocol': 'TCP', 'extended_service_name': 'HTTPS', 'port': 20000, 'service_name': 'HTTP'}], 'dns': {'reverse_dns': {'names': ['li617-160.members.linode.com']}}}, {'operating_system': {'cpe': 'cpe:2.3:o:*:linux:*:*:*:*:*:*:*:*', 'source': 'OSI_TRANSPORT_LAYER', 'part': 'o', 'other': [], 'product': 'linux', 'component_uniform_resource_identifiers': []}, 'services': [{'extended_service_name': 'FTPes', 'transport_protocol': 'TCP', 'certificate': '27cf8545c6d16087eb85cb4d58f679313683a692aa264bc95f3f127ba0a7679e', 'service_name': 'FTP', 'port': 21}, {'service_name': 'SSH', 'extended_service_name': 'SSH', 'transport_protocol': 'TCP', 'port': 22}, {'transport_protocol': 'TCP', 'port': 25, 'service_name': 'SMTP', 'certificate': '1002fdd02c6fe5a4ee589a0b6bd4c2203442b3752b0e5085fb0e1a09747199b5', 'extended_service_name': 'SMTP-STARTTLS'}, {'service_name': 'DNS', 'port': 53, 'transport_protocol': 'UDP', 'extended_service_name': 'DNS'}, {'port': 80, 'extended_service_name': 'HTTP', 'service_name': 'HTTP', 'transport_protocol': 'TCP'}, {'certificate': '1002fdd02c6fe5a4ee589a0b6bd4c2203442b3752b0e5085fb0e1a09747199b5', 'port': 110, 'transport_protocol': 'TCP', 'extended_service_name': 'POP3S', 'service_name': 'POP3'}, {'extended_service_name': 'NTP', 'transport_protocol': 'UDP', 'service_name': 'NTP', 'port': 123}, {'service_name': 'IMAP', 'certificate': '1002fdd02c6fe5a4ee589a0b6bd4c2203442b3752b0e5085fb0e1a09747199b5', 'extended_service_name': 'IMAPS', 'transport_protocol': 'TCP', 'port': 143}, {'extended_service_name': 'HTTPS', 'certificate': '1002fdd02c6fe5a4ee589a0b6bd4c2203442b3752b0e5085fb0e1a09747199b5', 'service_name': 'HTTP', 'transport_protocol': 'TCP', 'port': 443}, {'certificate': '1002fdd02c6fe5a4ee589a0b6bd4c2203442b3752b0e5085fb0e1a09747199b5', 'port': 465, 'transport_protocol': 'TCP', 'service_name': 'SMTP', 'extended_service_name': 'SMTPS'}, {'extended_service_name': 'SMTP-STARTTLS', 'port': 587, 'transport_protocol': 'TCP', 'service_name': 'SMTP', 'certificate': '1002fdd02c6fe5a4ee589a0b6bd4c2203442b3752b0e5085fb0e1a09747199b5'}, {'transport_protocol': 'TCP', 'service_name': 'IMAP', 'extended_service_name': 'IMAPS', 'certificate': '1002fdd02c6fe5a4ee589a0b6bd4c2203442b3752b0e5085fb0e1a09747199b5', 'port': 993}, {'extended_service_name': 'POP3S', 'transport_protocol': 'TCP', 'certificate': '1002fdd02c6fe5a4ee589a0b6bd4c2203442b3752b0e5085fb0e1a09747199b5', 'service_name': 'POP3', 'port': 995}], 'ip': '47.93.42.251', 'location': {'province': 'Beijing', 'coordinates': {'latitude': 39.9075, 'longitude': 116.39723}, 'timezone': 'Asia/Shanghai', 'continent': 'Asia', 'country': 'China', 'city': 'Beijing', 'country_code': 'CN'}, 'autonomous_system': {'bgp_prefix': '47.92.0.0/15', 'country_code': 'CN', 'asn': 37963, 'name': 'ALIBABA-CN-NET Hangzhou Alibaba Advertising Co.,Ltd.', 'description': 'ALIBABA-CN-NET Hangzhou Alibaba Advertising Co.,Ltd.'}, 'last_updated_at': '2024-03-27T17:17:06.644Z'}, {'last_updated_at': '2024-03-27T16:04:43.528Z', 'autonomous_system': {'description': 'TENCENT-NET-AP Shenzhen Tencent Computer Systems Company Limited', 'name': 'TENCENT-NET-AP Shenzhen Tencent Computer Systems Company Limited', 'country_code': 'CN', 'asn': 45090, 'bgp_prefix': '146.56.192.0/19'}, 'location': {'postal_code': '100000', 'country': 'China', 'continent': 'Asia', 'country_code': 'CN', 'province': 'Beijing', 'timezone': 'Asia/Shanghai', 'coordinates': {'latitude': 39.9075, 'longitude': 116.39723}, 'city': 'Beijing'}, 'ip': '146.56.218.179', 'services': [{'service_name': 'FTP', 'certificate': 'c1a7cce6106d87731e36f062362da682e151f6f917dbb226acc2db527213d0a8', 'extended_service_name': 'FTPes', 'port': 21, 'transport_protocol': 'TCP'}, {'port': 22, 'transport_protocol': 'TCP', 'extended_service_name': 'SSH', 'service_name': 'SSH'}, {'transport_protocol': 'TCP', 'service_name': 'HTTP', 'port': 80, 'extended_service_name': 'HTTP'}, {'service_name': 'HTTP', 'transport_protocol': 'TCP', 'port': 443, 'extended_service_name': 'HTTPS', 'certificate': 'ec2c0ec5f5c601538989b7ed8515bd6b21e4e0e1921fbd35d7c5c3dc41ff5edd'}, {'transport_protocol': 'TCP', 'service_name': 'HTTP', 'port': 888, 'extended_service_name': 'HTTP'}]}, {'services': [{'port': 21, 'transport_protocol': 'TCP', 'certificate': 'b4d9fe138974de04f2d7406fd088bb5e0e0a564362716b73b2baa3d4e8367ff7', 'extended_service_name': 'FTPes', 'service_name': 'FTP'}, {'service_name': 'SSH', 'port': 22, 'extended_service_name': 'SSH', 'transport_protocol': 'TCP'}, {'service_name': 'HTTP', 'extended_service_name': 'HTTP', 'port': 80, 'transport_protocol': 'TCP'}, {'port': 443, 'service_name': 'HTTP', 'extended_service_name': 'HTTPS', 'transport_protocol': 'TCP', 'certificate': '1c8d7576a2024bb769a9e9a6a6e04f40cfa2bde60a9c8ab63b42678abd36f52b'}, {'extended_service_name': 'HTTP', 'service_name': 'HTTP', 'transport_protocol': 'TCP', 'port': 8888}], 'operating_system': {'cpe': 'cpe:2.3:o:*:linux:*:*:*:*:*:*:*:*', 'product': 'linux', 'part': 'o', 'component_uniform_resource_identifiers': [], 'other': [], 'source': 'OSI_TRANSPORT_LAYER'}, 'location': {'province': 'Beijing', 'timezone': 'Asia/Shanghai', 'continent': 'Asia', 'country': 'China', 'postal_code': '100000', 'coordinates': {'longitude': 116.39723, 'latitude': 39.9075}, 'country_code': 'CN', 'city': 'Beijing'}, 'last_updated_at': '2024-03-27T23:57:33.584Z', 'ip': '47.93.8.153', 'autonomous_system': {'asn': 37963, 'bgp_prefix': '47.92.0.0/15', 'description': 'ALIBABA-CN-NET Hangzhou Alibaba Advertising Co.,Ltd.', 'country_code': 'CN', 'name': 'ALIBABA-CN-NET Hangzhou Alibaba Advertising Co.,Ltd.'}}, {'autonomous_system': {'country_code': 'CN', 'bgp_prefix': '120.24.0.0/16', 'asn': 37963, 'description': 'ALIBABA-CN-NET Hangzhou Alibaba Advertising Co.,Ltd.', 'name': 'ALIBABA-CN-NET Hangzhou Alibaba Advertising Co.,Ltd.'}, 'ip': '120.24.189.150', 'operating_system': {'component_uniform_resource_identifiers': [], 'cpe': 'cpe:2.3:o:*:linux:*:*:*:*:*:*:*:*', 'source': 'OSI_TRANSPORT_LAYER', 'other': [], 'product': 'linux', 'part': 'o'}, 'last_updated_at': '2024-03-27T23:41:52.179Z', 'services': [{'transport_protocol': 'TCP', 'certificate': '47dc035a5c5cb2d963f63c40dcc0ac2155c4a49d63b11317a2bbbeba7579e5d2', 'extended_service_name': 'FTPes', 'port': 21, 'service_name': 'FTP'}, {'extended_service_name': 'SSH', 'service_name': 'SSH', 'port': 22, 'transport_protocol': 'TCP'}, {'port': 80, 'service_name': 'HTTP', 'transport_protocol': 'TCP', 'extended_service_name': 'HTTP'}, {'transport_protocol': 'TCP', 'service_name': 'HTTP', 'extended_service_name': 'HTTP', 'port': 888}, {'transport_protocol': 'TCP', 'port': 3306, 'service_name': 'MYSQL', 'extended_service_name': 'MYSQL'}, {'extended_service_name': 'HTTP', 'transport_protocol': 'TCP', 'service_name': 'HTTP', 'port': 8888}], 'location': {'province': 'Guangdong', 'continent': 'Asia', 'country': 'China', 'coordinates': {'latitude': 22.54554, 'longitude': 114.0683}, 'country_code': 'CN', 'city': 'Shenzhen', 'timezone': 'Asia/Shanghai'}}, {'services': [{'transport_protocol': 'TCP', 'port': 80, 'extended_service_name': 'HTTP', 'service_name': 'HTTP'}], 'ip': '106.75.73.154', 'last_updated_at': '2024-03-27T11:41:01.030Z', 'autonomous_system': {'asn': 23724, 'bgp_prefix': '106.75.64.0/19', 'country_code': 'CN', 'name': 'CHINANET-IDC-BJ-AP IDC, China Telecommunications Corporation', 'description': 'CHINANET-IDC-BJ-AP IDC, China Telecommunications Corporation'}, 'location': {'coordinates': {'longitude': 116.39723, 'latitude': 39.9075}, 'country_code': 'CN', 'timezone': 'Asia/Shanghai', 'province': 'Beijing', 'city': 'Beijing', 'country': 'China', 'continent': 'Asia'}}, {'services': [{'port': 80, 'extended_service_name': 'HTTP', 'service_name': 'HTTP', 'transport_protocol': 'TCP'}, {'certificate': 'ffce4fd5f01ea0f747346dd18b6b39246bdc4e86a73cdc008e6f90de555b17da', 'transport_protocol': 'TCP', 'port': 443, 'extended_service_name': 'HTTPS', 'service_name': 'HTTP'}, {'service_name': 'HTTP', 'port': 8081, 'extended_service_name': 'HTTP', 'transport_protocol': 'TCP'}, {'service_name': 'HTTP', 'port': 8082, 'extended_service_name': 'HTTP', 'transport_protocol': 'TCP'}, {'service_name': 'HTTP', 'extended_service_name': 'HTTP', 'port': 8282, 'transport_protocol': 'TCP'}, {'extended_service_name': 'HTTP', 'service_name': 'HTTP', 'port': 21202, 'transport_protocol': 'TCP'}, {'service_name': 'SSH', 'transport_protocol': 'TCP', 'port': 45421, 'extended_service_name': 'SSH'}], 'last_updated_at': '2024-03-26T20:17:51.398Z', 'autonomous_system': {'asn': 133180, 'name': 'STARBOWLTD-AS-AP Starbow Ltd.', 'bgp_prefix': '154.194.128.0/18', 'country_code': 'JP', 'description': 'STARBOWLTD-AS-AP Starbow Ltd.'}, 'ip': '154.194.157.229', 'location': {'coordinates': {'latitude': 22.27832, 'longitude': 114.17469}, 'country': 'Hong Kong', 'country_code': 'HK', 'continent': 'Asia', 'city': 'Hong Kong', 'timezone': 'Asia/Hong_Kong'}}]
ip_port = [] 
for line in query:
   if line['ip']:
      print(line['ip'])
      for port in line['services']:
         if port['service_name'] == 'HTTP':
            print(port['port'])
            ip_port.append(f"{line['ip']}:{port['port']}")

print(ip_port)  